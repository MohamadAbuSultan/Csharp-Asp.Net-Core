## Hosting model for .NET APIs

### **نموذج الاستضافة (Hosting Model) لواجهات برمجة التطبيقات (APIs) في .NET**  

#### **مقدمة**  
في ASP.NET Core، يعتمد تشغيل التطبيقات على **نموذج الاستضافة (Hosting Model)**، والذي يتحكم في تشغيل التطبيق، وإدارة الخادم (Server)، وتكوين بيئة التنفيذ. في هذا الشرح، سنستعرض كيفية إعداد بيئة استضافة لمشروع **ASP.NET Core Web API** باستخدام **Visual Studio Code**، وسنتعرف على كيفية عمل هذا النموذج من خلال ملف `Program.cs`.

---

#### **إنشاء مشروع ASP.NET Core جديد**  
لبدء العمل، يمكننا إنشاء مشروع جديد باستخدام **C# Dev Kit** في **VS Code** عبر الخطوات التالية:  
1. فتح **VS Code**.  
2. اختيار **.NET: New Project** لإنشاء مشروع جديد.  
3. تحديد **ASP.NET Core Empty**، وهو قالب فارغ لتطبيق ويب.  
4. اختيار مجلد لحفظ المشروع الجديد.  
5. تسمية المشروع، مثل **MyNewApp** (يمكنك اختيار أي اسم تريده).  

بعد إنشاء المشروع، سيكون لدينا ملف **Program.cs**، وهو المسؤول عن **تكوين التطبيق (Application Configuration)** وإعداد البيئة التشغيلية.

---

#### **آلية عمل نموذج الاستضافة في ASP.NET Core**  
في **ASP.NET Core**، يتم تشغيل التطبيقات باستخدام **مضيف (Host)** يتولى المهام التالية:  
- بدء تشغيل التطبيق.  
- تكوين **خادم HTTP** لمعالجة الطلبات والاستجابات.  
- إعداد **خط أنابيب الطلب والاستجابة (Request-Response Pipeline)**.  

**نموذج الاستضافة في ASP.NET Core يتميز بالمرونة، حيث يمكن تعديله وتخصيصه حسب احتياجات التطبيق.**  

---

#### **تحليل ملف `Program.cs` في نموذج الاستضافة المصغر (Minimal Hosting Model)**  
عند فتح ملف `Program.cs`، ستجد الشيفرة الأساسية التالية:

```csharp
var builder = WebApplication.CreateBuilder(args);
var app = builder.Build();

app.Run();
```

##### **1. `WebApplication.CreateBuilder(args);`**  
- ينشئ كائن **builder** الذي يحتوي على **APIs** لتكوين بيئة الاستضافة.  
- يوفر الوصول إلى عدة خصائص مثل:
  - `builder.Host` → لتكوين المضيف.
  - `builder.Environment` → للوصول إلى إعدادات البيئة.
  - `builder.Configuration` → لتحميل الإعدادات الخاصة بالتطبيق.  

##### **2. `var app = builder.Build();`**  
- يقوم بإنشاء التطبيق بناءً على التكوينات المحددة في `builder`.  
- يجهز التطبيق لمعالجة الطلبات والاستجابات.  

##### **3. `app.Run();`**  
- يبدأ تشغيل **خادم HTTP** ومعالجة الطلبات الواردة إلى التطبيق.  
- يتم تشغيل التطبيق والاستماع إلى الطلبات القادمة من العملاء عبر الإنترنت.  

---

#### **أهمية نموذج الاستضافة في ASP.NET Core**  
✔ **تحكم كامل في إعدادات البيئة** – مثل تحديد بيئة التطوير (`Development` أو `Production`).  
✔ **إدارة متكاملة لخادم HTTP** – يمكن تكوين الخادم ليعمل مع Kestrel أو IIS أو غيرهما.  
✔ **سهولة التوسع والتخصيص** – يدعم إضافة مكونات مخصصة مثل **Middleware** و **Services**.  

---

#### **الخاتمة**  
يعد **نموذج الاستضافة (Hosting Model)** في **ASP.NET Core** الأساس الذي يقوم عليه تشغيل أي **Web API**، حيث يتولى مهام تكوين البيئة، وإعداد الخادم، ومعالجة الطلبات. من خلال فهم كيفية عمل `Program.cs`، يمكن للمطورين تخصيص إعدادات التطبيق بسهولة، مما يمنحهم تحكمًا كاملاً في تشغيل التطبيق وتطويره.